import 'package:intl/intl.dart';

class CurrencyService {
  final NumberFormat formatter;
  final NumberFormat formatterWithoutSymbol;

  CurrencyService({required this.formatter})
      : formatterWithoutSymbol = NumberFormat.currency(
          locale: formatter.locale,
          symbol: '', // No currency symbol
          decimalDigits: formatter.decimalDigits,
        );

  String toCurrency(dynamic amount) {
    if (amount == null || amount.toString().trim().isEmpty) {
      return formatter.format(0); // Return $0.00
    }

    final parsedAmount = _parseAmount(amount);
    return formatter.format(parsedAmount);
  }

  String toCurrencyWithoutSymbol(dynamic amount) {
    if (amount == null || amount.toString().trim().isEmpty) {
      return formatterWithoutSymbol.format(0); // Return 0.00
    }

    final parsedAmount = _parseAmount(amount);
    return formatterWithoutSymbol.format(parsedAmount);
  }

  num _parseAmount(dynamic amount) {
    if (amount is num) return amount;
    if (amount is String) {
      final parsed = num.tryParse(amount);
      if (parsed != null) return parsed;
      throw ArgumentError('Invalid input: "$amount" is not a valid number');
    }
    throw ArgumentError('Invalid type: ${amount.runtimeType}. Supported types: int, double, String');
  }
}